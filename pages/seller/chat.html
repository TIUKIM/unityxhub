<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Chat with Seller – UnityXhub</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Reuse Global CSS -->
    <link rel="stylesheet" href="../../css/style.css">

    <style>
        /* Chat Container */
        .chat-container {
            max-width: 900px;
            margin: 30px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            background: var(--primary);
            color: white;
            font-size: 1.6rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-body {
            height: 500px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 18px;
            line-height: 1.5;
            position: relative;
            font-size: 1rem;
        }

        .buyer-message {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .seller-message {
            align-self: flex-start;
            background: #e9ecef;
            color: var(--dark);
            border-bottom-left-radius: 5px;
        }

        .chat-footer {
            padding: 15px;
            border-top: 1px solid var(--gray);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
        }

        .send-btn {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .send-btn:hover {
            background: #e05d00;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo-section">
                <div class="site-title">UnityXhub</div>
                <div class="slogan">Chat with Seller</div>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="Search orders..." id="orderSearch">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            <div class="auth-buttons">
                <a href="../../index.html" class="btn btn-outline">
                    <i class="fas fa-home"></i> Home
                </a>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="nav-tabs">
        <div class="tabs-container">
            <a href="../../index.html"><i class="fas fa-home"></i> Home</a>
            <a href="../shopping.html"><i class="fas fa-shopping-cart"></i> Shopping</a>
            <a href="../../cart.html"><i class="fas fa-shopping-cart"></i> My Orders</a>
            <a href="#" class="active"><i class="fas fa-comments"></i> Chat</a>
        </div>
    </div>

    <!-- Chat Page -->
    <main>
        <div class="chat-container">
            <div class="chat-header">
                <i class="fas fa-user"></i> Tech Pro Store (Online)
            </div>

            <div class="chat-body" id="chatMessages">
                <!-- Messages will be loaded here -->
            </div>

            <div class="chat-footer">
                <input type="text" class="chat-input" id="messageInput" placeholder="Type your message...">
                <button class="send-btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </main>

    <div class="back-link">
        <a href="../../cart.html"><i class="fas fa-arrow-left"></i> Back to Orders</a>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <!-- Column 1: About UnityXhub -->
            <div class="footer-column">
                <h3>UnityXhub</h3>
                <p>Your one-stop digital ecosystem for shopping, jobs, freelancers, and community connections. Built by Filipinos for the global economy.</p>
                <div class="payment-methods">
                    <div class="payment-method">Visa</div>
                    <div class="payment-method">MC</div>
                    <div class="payment-method">PayPal</div>
                    <div class="payment-method">GCash</div>
                    <div class="payment-method">Bank</div>
                </div>
            </div>

            <!-- Column 2: Quick Links -->
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="../../index.html"><i class="fas fa-chevron-right"></i> Home</a></li>
                    <li><a href="../../cart.html"><i class="fas fa-chevron-right"></i> View Cart</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Track Order</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Return Policy</a></li>
                </ul>
            </div>

            <!-- Column 3: Support -->
            <div class="footer-column">
                <h3>Support</h3>
                <ul class="footer-links">
                    <li><a href="../../help-center.html"><i class="fas fa-chevron-right"></i> Help Center</a></li>
                    <li><a href="../../contact.html"><i class="fas fa-chevron-right"></i> Contact Us</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Buyer Protection</a></li>
                    <li><a href="../../report-issue.html"><i class="fas fa-chevron-right"></i> Report an Issue</a></li>
                    <li><a href="../../safety-tips.html"><i class="fas fa-chevron-right"></i> Safety Tips</a></li>
                </ul>
            </div>

            <!-- Column 4: Legal -->
            <div class="footer-column">
                <h3>Legal</h3>
                <ul class="footer-links">
                    <li><a href="../../about.html"><i class="fas fa-chevron-right"></i> About Us</a></li>
                    <li><a href="../../terms-of-service.html"><i class="fas fa-chevron-right"></i> Terms of Service</a></li>
                    <li><a href="../../privacy-policy.html"><i class="fas fa-chevron-right"></i> Privacy Policy</a></li>
                    <li><a href="../../cookies-policy.html"><i class="fas fa-chevron-right"></i> Cookie Policy</a></li>
                    <li><a href="../../disclaimer.html"><i class="fas fa-exclamation-triangle"></i> Platform Disclaimer</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 UnityXhub. All rights reserved. UnityXhub was built by Filipinos, for a global digital economy.
        </div>
    </footer>

    <!-- Cart Notification -->
    <div class="cart-notification" id="cartNotification">
        <i class="fas fa-check-circle"></i>
        <span>Message sent!</span>
    </div>

    <!-- Load Scripts -->
    <script src="../../js/main.js"></script>
    <script>
        // Unique chat ID (you can generate this per order or product)
        const chatId = 'buyer_techprostore_123'; // Format: buyer_seller_orderid
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const cartNotification = document.getElementById('cartNotification');

        // Load messages from localStorage
        function loadMessages() {
            const messages = JSON.parse(localStorage.getItem(`unityxhub_chat_${chatId}`) || '[]');
            chatMessages.innerHTML = '';

            messages.forEach(msg => {
                const msgEl = document.createElement('div');
                msgEl.className = msg.sender === 'buyer' ? 'message buyer-message' : 'message seller-message';
                msgEl.textContent = msg.text;
                chatMessages.appendChild(msgEl);
            });

            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Send message
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;

            const message = {
                sender: 'buyer',
                text: text,
                timestamp: new Date().toISOString(),
                read: false
            };

            // Load existing messages
            let messages = JSON.parse(localStorage.getItem(`unityxhub_chat_${chatId}`) || '[]');
            messages.push(message);

            // Save to localStorage
            localStorage.setItem(`unityxhub_chat_${chatId}`, JSON.stringify(messages));

            // Clear input & reload
            messageInput.value = '';
            loadMessages();
            showNotification("✅ Message sent to seller!", "var(--primary)");
        }

        // Show Notification
        function showNotification(message, color) {
            cartNotification.querySelector('span').textContent = message;
            cartNotification.style.background = color;
            cartNotification.classList.add('show');
            setTimeout(() => {
                cartNotification.classList.remove('show');
            }, 3000);
        }

        // Load on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadMessages();

            // Simulate seller reply after 2 seconds (for demo)
            setTimeout(() => {
                const replies = [
                    "Hi! Thanks for your message. How can I help you?",
                    "Your order is being processed and will ship within 24 hours.",
                    "Yes, we offer a 1-year warranty on this item."
                ];
                const randomReply = replies[Math.floor(Math.random() * replies.length)];
                
                const reply = {
                    sender: 'seller',
                    text: randomReply,
                    timestamp: new Date().toISOString()
                };
                
                let messages = JSON.parse(localStorage.getItem(`unityxhub_chat_${chatId}`) || '[]');
                messages.push(reply);
                localStorage.setItem(`unityxhub_chat_${chatId}`, JSON.stringify(messages));
                loadMessages();
            }, 2000);
        });

        // Allow Enter key to send
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>